{"ast":null,"code":"const baseURL = \"http://localhost:8080\";\n\nfunction makeURL(url, params = {}) {\n  let newURL = new URL(url, window.location.origin);\n  Object.keys(params).forEach(key => newURL.searchParams.append(key, params[key]));\n  return newURL;\n}\n\nfunction handleRtn(rsp, callback) {\n  if (rsp.code === 0) {\n    callback(rsp.data);\n  } else {\n    alert(rsp.message);\n  }\n}\n\nlet postFetch = (url, body, callback) => {\n  let completeURL = baseURL + url;\n  fetch(completeURL, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(body),\n    credentials: 'include'\n  }).then(rsp => rsp.json().then(rsp => {\n    handleRtn(rsp, callback);\n  }));\n};\n\nlet deleteFetch = (url, body, callback) => {\n  let completeURL = baseURL + url;\n  fetch(completeURL, {\n    method: \"DELETE\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(body),\n    credentials: 'include'\n  }).then(rsp => rsp.json().then(rsp => {\n    handleRtn(rsp, callback);\n  }));\n};\n\nlet getFetch = (url, params, callback) => {\n  let completeURL = makeURL(baseURL + url, params).href;\n  fetch(completeURL, {\n    method: \"GET\",\n    credentials: 'include'\n  }).then(rsp => rsp.json().then(rsp => {\n    handleRtn(rsp, callback);\n  })); // let completeURL = baseURL + url;\n  // axios.get(completeURL, {\n  //     params: params,\n  //     headers: {\n  //         'Authorization': \"Bearer \" + sessionStorage.getItem(\"token\")\n  //     }\n  // }).then((rsp) => callback(rsp));\n};\n\nexport { postFetch, deleteFetch, getFetch };","map":{"version":3,"sources":["F:/JavaProjects/ticket/src/function/fetch.js"],"names":["baseURL","makeURL","url","params","newURL","URL","window","location","origin","Object","keys","forEach","key","searchParams","append","handleRtn","rsp","callback","code","data","alert","message","postFetch","body","completeURL","fetch","method","headers","JSON","stringify","credentials","then","json","deleteFetch","getFetch","href"],"mappings":"AAAA,MAAMA,OAAO,GAAG,uBAAhB;;AAEA,SAASC,OAAT,CAAiBC,GAAjB,EAAsBC,MAAM,GAAG,EAA/B,EAAmC;AAC/B,MAAIC,MAAM,GAAG,IAAIC,GAAJ,CAAQH,GAAR,EAAaI,MAAM,CAACC,QAAP,CAAgBC,MAA7B,CAAb;AACAC,EAAAA,MAAM,CAACC,IAAP,CAAYP,MAAZ,EAAoBQ,OAApB,CAA4BC,GAAG,IAAIR,MAAM,CAACS,YAAP,CAAoBC,MAApB,CAA2BF,GAA3B,EAAgCT,MAAM,CAACS,GAAD,CAAtC,CAAnC;AACA,SAAOR,MAAP;AACH;;AAGD,SAASW,SAAT,CAAmBC,GAAnB,EAAwBC,QAAxB,EAAkC;AAC9B,MAAID,GAAG,CAACE,IAAJ,KAAa,CAAjB,EAAoB;AAChBD,IAAAA,QAAQ,CAACD,GAAG,CAACG,IAAL,CAAR;AACH,GAFD,MAEO;AACHC,IAAAA,KAAK,CAACJ,GAAG,CAACK,OAAL,CAAL;AACH;AACJ;;AAED,IAAIC,SAAS,GAAG,CAACpB,GAAD,EAAMqB,IAAN,EAAYN,QAAZ,KAAyB;AACrC,MAAIO,WAAW,GAAGxB,OAAO,GAAGE,GAA5B;AACAuB,EAAAA,KAAK,CAACD,WAAD,EAAc;AACfE,IAAAA,MAAM,EAAE,MADO;AAEfC,IAAAA,OAAO,EAAE;AACL,sBAAgB;AADX,KAFM;AAKfJ,IAAAA,IAAI,EAAEK,IAAI,CAACC,SAAL,CAAeN,IAAf,CALS;AAMfO,IAAAA,WAAW,EAAE;AANE,GAAd,CAAL,CAOGC,IAPH,CAOQf,GAAG,IAAIA,GAAG,CAACgB,IAAJ,GAAWD,IAAX,CAAgBf,GAAG,IAAI;AAClCD,IAAAA,SAAS,CAACC,GAAD,EAAMC,QAAN,CAAT;AACH,GAFc,CAPf;AAUH,CAZD;;AAcA,IAAIgB,WAAW,GAAG,CAAC/B,GAAD,EAAMqB,IAAN,EAAYN,QAAZ,KAAyB;AACvC,MAAIO,WAAW,GAAGxB,OAAO,GAAGE,GAA5B;AACAuB,EAAAA,KAAK,CAACD,WAAD,EAAc;AACfE,IAAAA,MAAM,EAAE,QADO;AAEfC,IAAAA,OAAO,EAAE;AACL,sBAAgB;AADX,KAFM;AAKfJ,IAAAA,IAAI,EAAEK,IAAI,CAACC,SAAL,CAAeN,IAAf,CALS;AAMfO,IAAAA,WAAW,EAAE;AANE,GAAd,CAAL,CAOGC,IAPH,CAOQf,GAAG,IAAIA,GAAG,CAACgB,IAAJ,GAAWD,IAAX,CAAgBf,GAAG,IAAI;AAClCD,IAAAA,SAAS,CAACC,GAAD,EAAMC,QAAN,CAAT;AACH,GAFc,CAPf;AAUH,CAZD;;AAcA,IAAIiB,QAAQ,GAAG,CAAChC,GAAD,EAAMC,MAAN,EAAcc,QAAd,KAA2B;AACtC,MAAIO,WAAW,GAAGvB,OAAO,CAACD,OAAO,GAAGE,GAAX,EAAgBC,MAAhB,CAAP,CAA+BgC,IAAjD;AACAV,EAAAA,KAAK,CAACD,WAAD,EAAc;AACfE,IAAAA,MAAM,EAAE,KADO;AAEfI,IAAAA,WAAW,EAAE;AAFE,GAAd,CAAL,CAGGC,IAHH,CAGQf,GAAG,IAAIA,GAAG,CAACgB,IAAJ,GAAWD,IAAX,CAAgBf,GAAG,IAAI;AAClCD,IAAAA,SAAS,CAACC,GAAD,EAAMC,QAAN,CAAT;AACH,GAFc,CAHf,EAFsC,CAQtC;AACA;AACA;AACA;AACA;AACA;AACA;AACH,CAfD;;AAiBA,SAAQK,SAAR,EAAmBW,WAAnB,EAAgCC,QAAhC","sourcesContent":["const baseURL = \"http://localhost:8080\";\r\n\r\nfunction makeURL(url, params = {}) {\r\n    let newURL = new URL(url, window.location.origin);\r\n    Object.keys(params).forEach(key => newURL.searchParams.append(key, params[key]));\r\n    return newURL;\r\n}\r\n\r\n\r\nfunction handleRtn(rsp, callback) {\r\n    if (rsp.code === 0) {\r\n        callback(rsp.data);\r\n    } else {\r\n        alert(rsp.message);\r\n    }\r\n}\r\n\r\nlet postFetch = (url, body, callback) => {\r\n    let completeURL = baseURL + url;\r\n    fetch(completeURL, {\r\n        method: \"POST\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(body),\r\n        credentials: 'include'\r\n    }).then(rsp => rsp.json().then(rsp => {\r\n        handleRtn(rsp, callback);\r\n    }))\r\n};\r\n\r\nlet deleteFetch = (url, body, callback) => {\r\n    let completeURL = baseURL + url;\r\n    fetch(completeURL, {\r\n        method: \"DELETE\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(body),\r\n        credentials: 'include'\r\n    }).then(rsp => rsp.json().then(rsp => {\r\n        handleRtn(rsp, callback);\r\n    }))\r\n};\r\n\r\nlet getFetch = (url, params, callback) => {\r\n    let completeURL = makeURL(baseURL + url, params).href;\r\n    fetch(completeURL, {\r\n        method: \"GET\",\r\n        credentials: 'include',\r\n    }).then(rsp => rsp.json().then(rsp => {\r\n        handleRtn(rsp, callback);\r\n    }));\r\n    // let completeURL = baseURL + url;\r\n    // axios.get(completeURL, {\r\n    //     params: params,\r\n    //     headers: {\r\n    //         'Authorization': \"Bearer \" + sessionStorage.getItem(\"token\")\r\n    //     }\r\n    // }).then((rsp) => callback(rsp));\r\n};\r\n\r\nexport {postFetch, deleteFetch, getFetch}"]},"metadata":{},"sourceType":"module"}