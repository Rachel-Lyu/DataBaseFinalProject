{"ast":null,"code":"import _classCallCheck from\"/home/zhu/Code/IdeaProjects/ticket/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/zhu/Code/IdeaProjects/ticket/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/zhu/Code/IdeaProjects/ticket/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/zhu/Code/IdeaProjects/ticket/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React from\"react\";import{Button,Form,Input,Select}from'antd';import'antd/dist/antd.css';import{postFetch}from\"../function/fetch\";var Option=Select.Option;var prefixSelector=/*#__PURE__*/_jsx(Form.Item,{name:\"prefix\",noStyle:true,children:/*#__PURE__*/_jsxs(Select,{style:{width:70},children:[/*#__PURE__*/_jsx(Option,{value:\"86\",children:\"+86\"}),/*#__PURE__*/_jsx(Option,{value:\"87\",children:\"+87\"})]})});var RegisterPage=/*#__PURE__*/function(_React$Component){_inherits(RegisterPage,_React$Component);var _super=_createSuper(RegisterPage);function RegisterPage(props){var _this;_classCallCheck(this,RegisterPage);_this=_super.call(this,props);_this.login=function(){var id=_this.state.id;var pw=_this.state.pw;fetch('api/api/login?id='+id+\"&password=\"+pw,{method:'GET',cache:'default'}).then(function(rsp){return rsp.json().then(function(rsp){if(rsp.code!=0)console.log(rsp);else{console.log(rsp);localStorage.setItem('log',1);localStorage.setItem('id',_this.state.id);_this.props.history.push(\"/tickets\");}});});};_this.state={id:\"\",nickname:\"\",pw:\"\",pw1:\"\",pw2:\"\"};return _this;}_createClass(RegisterPage,[{key:\"GotoLogIn\",value:function GotoLogIn(){this.props.history.push('/login');}},{key:\"submitRegister\",value:function submitRegister(){var _this2=this;if(this.state.id.length>0&&this.state.nickname.length>0&&this.state.pw.length>0){postFetch('/user/register',{name:this.state.nickname,id:this.state.id,password:this.state.pw},function(rsp){_this2.login();});}}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{style:{maxWidth:\"500px\",padding:\"15px\",margin:\"0 auto\"},children:/*#__PURE__*/_jsxs(Form,{style:{maxWidth:\"300px\",margin:\"0 auto\"},name:\"register\",initialValues:{prefix:'86'},scrollToFirstError:true,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"id\",rules:[{required:true,message:'请输入id'}],children:/*#__PURE__*/_jsx(Input,{id:\"idInput\",placeholder:\"输入id\",onChange:function onChange(e){_this3.setState({id:e.target.value});}})}),/*#__PURE__*/_jsx(Form.Item,{name:\"password\",rules:[{required:true,message:'请输入密码'}],hasFeedback:true,children:/*#__PURE__*/_jsx(Input.Password,{id:\"pw1\",onChange:function onChange(e){if(e.target.value===_this3.state.pw2){_this3.setState({pw1:e.target.value,pw:e.target.value});}else{_this3.setState({pw1:e.target.value});}},placeholder:\"设置密码\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"confirm\",dependencies:['password'],hasFeedback:true,rules:[{required:true,message:'请确认密码'},function(_ref){var getFieldValue=_ref.getFieldValue;return{validator:function validator(rule,value){if(!value||getFieldValue('password')===value){return Promise.resolve();}return Promise.reject('两次输入不一致');}};}],children:/*#__PURE__*/_jsx(Input.Password,{id:\"pw2\",onChange:function onChange(e){if(e.target.value===_this3.state.pw1){console.log(\"here\");_this3.setState({pw2:e.target.value,pw:e.target.value});}else{_this3.setState({pw2:e.target.value});}},placeholder:\"确认密码\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"nickname\",rules:[{required:true,message:'请输入昵称',whitespace:true}],children:/*#__PURE__*/_jsx(Input,{id:\"nameInput\",placeholder:\"设置昵称\",onChange:function onChange(e){_this3.setState({nickname:e.target.value});}})}),/*#__PURE__*/_jsxs(Form.Item,{style:{maxWidth:\"200px\",margin:\"0 auto\"},children:[/*#__PURE__*/_jsx(Button,{id:\"submitButton\",type:\"primary\",htmlType:\"submit\",style:{float:\"left\"},onClick:function onClick(){_this3.submitRegister();},children:\"\\u6CE8\\u518C\"}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",style:{float:\"right\"},onClick:function onClick(){return _this3.GotoLogIn();},children:\"\\u8FD4\\u56DE\"})]})]})})});}}]);return RegisterPage;}(React.Component);export{RegisterPage as default};","map":{"version":3,"sources":["/home/zhu/Code/IdeaProjects/ticket/src/page/RegisterPage.js"],"names":["React","Button","Form","Input","Select","postFetch","Option","prefixSelector","width","RegisterPage","props","login","id","state","pw","fetch","method","cache","then","rsp","json","code","console","log","localStorage","setItem","history","push","nickname","pw1","pw2","length","name","password","maxWidth","padding","margin","prefix","required","message","e","setState","target","value","getFieldValue","validator","rule","Promise","resolve","reject","whitespace","float","submitRegister","GotoLogIn","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport {Button, Form, Input, Select} from 'antd';\r\nimport 'antd/dist/antd.css';\r\nimport {postFetch} from \"../function/fetch\";\r\n\r\nconst {Option} = Select;\r\n\r\nconst prefixSelector = (\r\n    <Form.Item name=\"prefix\" noStyle>\r\n        <Select\r\n            style={{\r\n                width: 70,\r\n            }}\r\n        >\r\n            <Option value=\"86\">+86</Option>\r\n            <Option value=\"87\">+87</Option>\r\n        </Select>\r\n    </Form.Item>\r\n);\r\n\r\nexport default class RegisterPage extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            id: \"\",\r\n            nickname: \"\",\r\n            pw: \"\",\r\n            pw1: \"\",\r\n            pw2: \"\",\r\n        }\r\n\r\n    }\r\n\r\n    GotoLogIn() {\r\n        this.props.history.push('/login');\r\n    }\r\n\r\n    login = () => {\r\n        let id = this.state.id\r\n        let pw = this.state.pw\r\n        fetch('api/api/login?id='+id+\"&password=\"+pw,{\r\n            method:'GET',\r\n            cache:'default'\r\n        }).then(rsp => rsp.json().then(rsp => {\r\n            if(rsp.code!=0)\r\n                console.log(rsp);\r\n            else {\r\n                console.log(rsp);\r\n                localStorage.setItem('log',1);\r\n                localStorage.setItem('id',this.state.id);\r\n                this.props.history.push(\"/tickets\")\r\n            }\r\n        }))\r\n    };\r\n\r\n\r\n    submitRegister() {\r\n        if ((this.state.id.length > 0)\r\n            && (this.state.nickname.length > 0)\r\n            && (this.state.pw.length > 0)) {\r\n            postFetch('/user/register',\r\n                {\r\n                    name: this.state.nickname,\r\n                    id: this.state.id,\r\n                    password: this.state.pw,\r\n                }, (rsp) => {\r\n                    this.login();\r\n                }\r\n            );\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div>\r\n                <div style={{\r\n                    maxWidth: \"500px\",\r\n                    padding: \"15px\",\r\n                    margin: \"0 auto\"\r\n                }}>\r\n                    <Form\r\n                        style={{\r\n                            maxWidth: \"300px\",\r\n                            margin: \"0 auto\"\r\n                        }}\r\n                        name=\"register\"\r\n                        initialValues={{\r\n                            prefix: '86',\r\n                        }}\r\n                        scrollToFirstError\r\n                    >\r\n                        <Form.Item\r\n                            name=\"id\"\r\n                            rules={[\r\n                                {\r\n                                    required: true,\r\n                                    message: '请输入id',\r\n                                },\r\n                            ]}\r\n                        >\r\n                            <Input\r\n                                id=\"idInput\"\r\n                                placeholder={\"输入id\"}\r\n                                onChange={(e) => {\r\n                                    this.setState({id: e.target.value})\r\n                                }}\r\n                            />\r\n                        </Form.Item>\r\n\r\n                        <Form.Item\r\n                            name=\"password\"\r\n                            rules={[\r\n                                {\r\n                                    required: true,\r\n                                    message: '请输入密码',\r\n                                },\r\n                            ]}\r\n                            hasFeedback\r\n                        >\r\n                            <Input.Password\r\n                                id=\"pw1\"\r\n                                onChange={(e) => {\r\n                                    if (e.target.value === this.state.pw2) {\r\n                                        this.setState({\r\n                                            pw1: e.target.value,\r\n                                            pw: e.target.value\r\n                                        });\r\n                                    } else {\r\n                                        this.setState({\r\n                                            pw1: e.target.value\r\n                                        });\r\n                                    }\r\n                                }}\r\n                                placeholder={\"设置密码\"}/>\r\n                        </Form.Item>\r\n\r\n                        <Form.Item\r\n                            name=\"confirm\"\r\n                            dependencies={['password']}\r\n                            hasFeedback\r\n                            rules={[\r\n                                {\r\n                                    required: true,\r\n                                    message: '请确认密码',\r\n                                },\r\n                                ({getFieldValue}) => ({\r\n                                    validator(rule, value) {\r\n                                        if (!value || getFieldValue('password') === value) {\r\n                                            return Promise.resolve();\r\n                                        }\r\n\r\n                                        return Promise.reject('两次输入不一致');\r\n                                    },\r\n                                }),\r\n                            ]}\r\n                        >\r\n                            <Input.Password\r\n                                id=\"pw2\"\r\n                                onChange={(e) => {\r\n                                    if (e.target.value === this.state.pw1) {\r\n                                        console.log(\"here\")\r\n                                        this.setState({\r\n                                            pw2: e.target.value,\r\n                                            pw: e.target.value\r\n                                        });\r\n                                    } else {\r\n                                        this.setState({\r\n                                            pw2: e.target.value\r\n                                        });\r\n                                    }\r\n                                }}\r\n                                placeholder={\"确认密码\"}/>\r\n                        </Form.Item>\r\n\r\n                        <Form.Item\r\n                            name=\"nickname\"\r\n                            rules={[\r\n                                {\r\n                                    required: true,\r\n                                    message: '请输入昵称',\r\n                                    whitespace: true,\r\n                                },\r\n                            ]}\r\n                        >\r\n                            <Input\r\n                                id=\"nameInput\"\r\n                                placeholder={\"设置昵称\"}\r\n                                onChange={(e) => {\r\n                                    this.setState({nickname: e.target.value})\r\n                                }}\r\n                            />\r\n                        </Form.Item>\r\n\r\n                        <Form.Item style={{maxWidth: \"200px\", margin: \"0 auto\"}}>\r\n                            <Button\r\n                                id=\"submitButton\"\r\n                                type=\"primary\"\r\n                                htmlType=\"submit\"\r\n                                style={{float: \"left\"}}\r\n                                onClick={() => {\r\n                                    this.submitRegister()\r\n                                }}\r\n                            >\r\n                                注册\r\n                            </Button>\r\n                            <Button\r\n                                type=\"primary\"\r\n                                htmlType=\"submit\"\r\n                                style={{float: \"right\"}}\r\n                                onClick={() => this.GotoLogIn()}\r\n                            >\r\n                                返回\r\n                            </Button>\r\n\r\n                        </Form.Item>\r\n                    </Form>\r\n\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}