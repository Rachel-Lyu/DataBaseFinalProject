{"ast":null,"code":"const baseURL = \"http://localhost:8080/api\";\n\nfunction makeURL(url, params = {}) {\n  let newURL = new URL(url, window.location.origin);\n  Object.keys(params).forEach(key => newURL.searchParams.append(key, params[key]));\n  return newURL;\n}\n\nfunction handleRtn(rsp, callback) {\n  if (rsp.code === 0) {\n    callback(rsp.data);\n  } else {\n    alert(rsp.msg);\n  }\n}\n\nlet postFetch = (url, body, callback) => {\n  let completeURL = baseURL + url;\n  console.log(JSON.stringify(body)); // fetch(completeURL, {\n  //     method: \"POST\",\n  //     mode: \"cors\",\n  //     cache:'default',\n  //     headers: {\n  //         \"Content-Type\": \"application/json\",\n  //     },\n  //     body: JSON.stringify(body),\n  // }).then(rsp => rsp.json().then(rsp => {\n  //     handleRtn(rsp, callback);\n  // }))\n};\n\nlet deleteFetch = (url, body, callback) => {\n  let completeURL = baseURL + url;\n  fetch(completeURL, {\n    method: \"DELETE\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(body),\n    credentials: 'include'\n  }).then(rsp => rsp.then(rsp => {\n    console.log(rsp);\n  }));\n};\n\nlet getFetch = (url, params, callback) => {\n  let completeURL = makeURL(baseURL + url, params).href;\n  console.log(completeURL);\n  fetch(completeURL, {\n    method: \"GET\",\n    cache: 'default',\n    mode: \"cors\"\n  }).then(rsp => rsp.json().then(rsp => {\n    console.log(rsp);\n    handleRtn(rsp, callback);\n  })); // let completeURL = baseURL + url;\n  // axios.get(completeURL, {\n  //     params: params,\n  //     headers: {\n  //         'Authorization': \"Bearer \" + sessionStorage.getItem(\"token\")\n  //     }\n  // }).then((rsp) => callback(rsp));\n};\n\nexport { postFetch, deleteFetch, getFetch };","map":{"version":3,"sources":["/run/media/zhu/LENOVO_USB_HDD/ticket/src/function/fetch.js"],"names":["baseURL","makeURL","url","params","newURL","URL","window","location","origin","Object","keys","forEach","key","searchParams","append","handleRtn","rsp","callback","code","data","alert","msg","postFetch","body","completeURL","console","log","JSON","stringify","deleteFetch","fetch","method","headers","credentials","then","getFetch","href","cache","mode","json"],"mappings":"AAAA,MAAMA,OAAO,GAAG,2BAAhB;;AAEA,SAASC,OAAT,CAAiBC,GAAjB,EAAsBC,MAAM,GAAG,EAA/B,EAAmC;AAC/B,MAAIC,MAAM,GAAG,IAAIC,GAAJ,CAAQH,GAAR,EAAaI,MAAM,CAACC,QAAP,CAAgBC,MAA7B,CAAb;AACAC,EAAAA,MAAM,CAACC,IAAP,CAAYP,MAAZ,EAAoBQ,OAApB,CAA4BC,GAAG,IAAIR,MAAM,CAACS,YAAP,CAAoBC,MAApB,CAA2BF,GAA3B,EAAgCT,MAAM,CAACS,GAAD,CAAtC,CAAnC;AACA,SAAOR,MAAP;AACH;;AAGD,SAASW,SAAT,CAAmBC,GAAnB,EAAwBC,QAAxB,EAAkC;AAC9B,MAAID,GAAG,CAACE,IAAJ,KAAa,CAAjB,EAAoB;AAChBD,IAAAA,QAAQ,CAACD,GAAG,CAACG,IAAL,CAAR;AACH,GAFD,MAEO;AACHC,IAAAA,KAAK,CAACJ,GAAG,CAACK,GAAL,CAAL;AACH;AACJ;;AAED,IAAIC,SAAS,GAAG,CAACpB,GAAD,EAAMqB,IAAN,EAAYN,QAAZ,KAAyB;AACrC,MAAIO,WAAW,GAAGxB,OAAO,GAAGE,GAA5B;AACAuB,EAAAA,OAAO,CAACC,GAAR,CAAYC,IAAI,CAACC,SAAL,CAAeL,IAAf,CAAZ,EAFqC,CAGrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH,CAdD;;AAgBA,IAAIM,WAAW,GAAG,CAAC3B,GAAD,EAAMqB,IAAN,EAAYN,QAAZ,KAAyB;AACvC,MAAIO,WAAW,GAAGxB,OAAO,GAAGE,GAA5B;AACA4B,EAAAA,KAAK,CAACN,WAAD,EAAc;AACfO,IAAAA,MAAM,EAAE,QADO;AAEfC,IAAAA,OAAO,EAAE;AACL,sBAAgB;AADX,KAFM;AAKfT,IAAAA,IAAI,EAAEI,IAAI,CAACC,SAAL,CAAeL,IAAf,CALS;AAMfU,IAAAA,WAAW,EAAE;AANE,GAAd,CAAL,CAOGC,IAPH,CAOQlB,GAAG,IAAIA,GAAG,CAACkB,IAAJ,CAASlB,GAAG,IAAI;AAC3BS,IAAAA,OAAO,CAACC,GAAR,CAAYV,GAAZ;AACH,GAFc,CAPf;AAUH,CAZD;;AAcA,IAAImB,QAAQ,GAAG,CAACjC,GAAD,EAAMC,MAAN,EAAcc,QAAd,KAA2B;AACtC,MAAIO,WAAW,GAAGvB,OAAO,CAACD,OAAO,GAAGE,GAAX,EAAgBC,MAAhB,CAAP,CAA+BiC,IAAjD;AACAX,EAAAA,OAAO,CAACC,GAAR,CAAYF,WAAZ;AACAM,EAAAA,KAAK,CAACN,WAAD,EAAc;AACfO,IAAAA,MAAM,EAAE,KADO;AAEfM,IAAAA,KAAK,EAAC,SAFS;AAGfC,IAAAA,IAAI,EAAE;AAHS,GAAd,CAAL,CAIGJ,IAJH,CAIQlB,GAAG,IAAIA,GAAG,CAACuB,IAAJ,GAAWL,IAAX,CAAgBlB,GAAG,IAAI;AAClCS,IAAAA,OAAO,CAACC,GAAR,CAAYV,GAAZ;AACAD,IAAAA,SAAS,CAACC,GAAD,EAAMC,QAAN,CAAT;AACH,GAHc,CAJf,EAHsC,CAWtC;AACA;AACA;AACA;AACA;AACA;AACA;AACH,CAlBD;;AAoBA,SAAQK,SAAR,EAAmBO,WAAnB,EAAgCM,QAAhC","sourcesContent":["const baseURL = \"http://localhost:8080/api\";\r\n\r\nfunction makeURL(url, params = {}) {\r\n    let newURL = new URL(url, window.location.origin);\r\n    Object.keys(params).forEach(key => newURL.searchParams.append(key, params[key]));\r\n    return newURL;\r\n}\r\n\r\n\r\nfunction handleRtn(rsp, callback) {\r\n    if (rsp.code === 0) {\r\n        callback(rsp.data);\r\n    } else {\r\n        alert(rsp.msg);\r\n    }\r\n}\r\n\r\nlet postFetch = (url, body, callback) => {\r\n    let completeURL = baseURL + url;\r\n    console.log(JSON.stringify(body));\r\n    // fetch(completeURL, {\r\n    //     method: \"POST\",\r\n    //     mode: \"cors\",\r\n    //     cache:'default',\r\n    //     headers: {\r\n    //         \"Content-Type\": \"application/json\",\r\n    //     },\r\n    //     body: JSON.stringify(body),\r\n    // }).then(rsp => rsp.json().then(rsp => {\r\n    //     handleRtn(rsp, callback);\r\n    // }))\r\n};\r\n\r\nlet deleteFetch = (url, body, callback) => {\r\n    let completeURL = baseURL + url;\r\n    fetch(completeURL, {\r\n        method: \"DELETE\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(body),\r\n        credentials: 'include'\r\n    }).then(rsp => rsp.then(rsp => {\r\n        console.log(rsp)\r\n    }))\r\n};\r\n\r\nlet getFetch = (url, params, callback) => {\r\n    let completeURL = makeURL(baseURL + url, params).href;\r\n    console.log(completeURL)\r\n    fetch(completeURL, {\r\n        method: \"GET\",\r\n        cache:'default',\r\n        mode: \"cors\"\r\n    }).then(rsp => rsp.json().then(rsp => {\r\n        console.log(rsp)\r\n        handleRtn(rsp, callback);\r\n    }));\r\n    // let completeURL = baseURL + url;\r\n    // axios.get(completeURL, {\r\n    //     params: params,\r\n    //     headers: {\r\n    //         'Authorization': \"Bearer \" + sessionStorage.getItem(\"token\")\r\n    //     }\r\n    // }).then((rsp) => callback(rsp));\r\n};\r\n\r\nexport {postFetch, deleteFetch, getFetch}"]},"metadata":{},"sourceType":"module"}